
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dance of the COVID-19: The Regression Model of the Vaccine Hesitancy &#8212; UC Irvine Math 10 S22</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Depression Prediction" href="TongSu.html" />
    <link rel="prev" title="Airline Satisfaction Analysis" href="MitraRezvany.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/digitsyellow.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UC Irvine Math 10 S22</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   UC Irvine, Math 10, Spring 2022
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week1/Week1-Intro.html">
   Week 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Monday.html">
     Introduction to pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Tuesday.html">
     Week 1 Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Wednesday.html">
     for loops and ways to avoid for loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Thursday.html">
     Week 1 Thursday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Friday.html">
     Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Videos.html">
     Week 1 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Homework1.html">
     Homework 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week2/Week2-Intro.html">
   Week 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Monday.html">
     Working with missing data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Tuesday.html">
     Week 2 Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Wednesday.html">
     Visualization in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Videos.html">
     Week 2 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Friday.html">
     Plots from the Spotify dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Homework2.html">
     Homework 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week3/Week3-Intro.html">
   Week 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Monday.html">
     Functions in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Tuesday.html">
     Week 3 Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Wednesday.html">
     Working with dates in pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Videos.html">
     Week 3 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Homework3.html">
     Homework 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week4/Week4-Intro.html">
   Week 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Monday.html">
     Week 4 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Videos.html">
     Week 4 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Tuesday.html">
     Week 4, Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Wednesday.html">
     Practice with Altair
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Friday.html">
     Rescaling data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week5/Week5-Intro.html">
   Week 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Monday.html">
     K-Means clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Wednesday.html">
     K-Means clustering 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Videos.html">
     Week 5 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Homework4.html">
     Homework 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Thursday.html">
     Week 5, Thursday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Friday.html">
     K-Means clustering 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week6/Week6-Intro.html">
   Week 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Monday.html">
     Polynomial Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Tuesday.html">
     Week 6, Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Wednesday.html">
     Polynomial Regression 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Friday.html">
     Linear and Polynomial Regression with the taxis dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Homework5.html">
     Homework 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Videos.html">
     Week 6 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week7/Week7-Intro.html">
   Week 7
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Monday.html">
     Performance measures for machine learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Tuesday.html">
     Week 7, Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Wednesday.html">
     Overfitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Thursday.html">
     Week 7, Thursday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Friday.html">
     Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Videos.html">
     Week 7 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Homework6.html">
     Homework 6
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week8/Week8-Intro.html">
   Week 8
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Monday.html">
     Decision boundary for logistic regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Tuesday.html">
     Week 8, Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Wednesday.html">
     Midterm Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Videos.html">
     Week 8 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Homework7.html">
     Homework 7
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week9/Week9-Intro.html">
   Week 9
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Monday.html">
     Week 9 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Tuesday.html">
     Week 9, Tuesday Discussion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Wednesday.html">
     Feature Engineering with the Titanic dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Friday.html">
     Decision Trees and Random Forests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Videos.html">
     Week 9 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Homework8.html">
     Homework 8
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week10/Week10-Intro.html">
   Week 10
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week10/Week10-Wednesday.html">
     House prices in King County Washington
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week10/Week10-Videos.html">
     Week 10 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Proj-Intro.html">
   Course Project
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../CourseProject.html">
     Course Project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ExtraTopics.html">
     Possible extra topics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../StudentProjects.html">
   Student Projects
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="DongyuCao.html">
     Analysis of the factors that influence car’s level
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AlisaCrowe.html">
     Zoo Animal Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="TianyiChen.html">
     League of Legends Winning Factor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="SebastiandeLeon.html">
     Canadian Immigration Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="YiDing.html">
     Dota2 match outcome prediction based on mid player performance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MayaDrusinsky.html">
     Exoplanet Candidate Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="JingxiFeng.html">
     Analysis of the Alcohol Drinking in UCI Student
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="XiangboGao.html">
     Real vs fake faces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="SonghanHu.html">
     Analysis of GDP Related to Pandemic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MarcusLei.html">
     Betting odds and outcome of UFC fights from 2010-2020
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="KehanLi.html">
     Predict The Car Price
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="KexinLi.html">
     Unemployment Rate Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="XuanruLi.html">
     Project Title :Stock Price of Famous Companies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="JieLin.html">
     Predict the Month through London Weather
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="EvanMcDuffie.html">
     Categorizing Beans
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="QuanAnhNguyen.html">
     An Analysis of the Financial Market: Inflation and the Efficient Market Hypothesis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="JeffreyPham.html">
     Predicting an Activity of Mine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MitraRezvany.html">
     Airline Satisfaction Analysis
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Dance of the COVID-19: The Regression Model of the Vaccine Hesitancy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="TongSu.html">
     Depression Prediction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MiaTa.html">
     Apple Stock
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LinglinTian.html">
     Analysis of credit card fraud
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="JoshTseng.html">
     Chess Games Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HuyTran.html">
     Predicting COVID-19 Trends
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ZhongWang.html">
     NBA Salaries from the 2017 Season
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="YadiWu.html">
     Fraudulent And Non-fraudulent Transactions in Credit Cards
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NingyueXu.html">
     Sorting the number of planets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="JingqiYao.html">
     Fashion MNIST
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="WenqiZhao.html">
     Pokemon
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LinjunZhou.html">
     Payment and treatment in U.S. Hospital
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="XiangyiZhu.html">
     Tesla Stock Price Prediction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../sched.html">
   Tentative schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../datasources.html">
   Data Sources
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Proj/StudentProjects/JiahuiSheng.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ChristopherDavisUCI/UCI-Math-10-S22"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-portion-of-the-project">
   Main portion of the project
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Dance of the COVID-19: The Regression Model of the Vaccine Hesitancy</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-portion-of-the-project">
   Main portion of the project
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="dance-of-the-covid-19-the-regression-model-of-the-vaccine-hesitancy">
<h1>Dance of the COVID-19: The Regression Model of the Vaccine Hesitancy<a class="headerlink" href="#dance-of-the-covid-19-the-regression-model-of-the-vaccine-hesitancy" title="Permalink to this headline">¶</a></h1>
<p>Author: Jiahui Sheng</p>
<p>Course Project, UC Irvine, Math 10, S22</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>To investigate and predict vaccine hesitancy in America, a Kaggle dataset is proposed with the variable of the party, the sex, etc. Initially, to implement the data preprocessing, the padding NaN filling method is applied and the text is converted to the number by pandas. Then, the KMeans method is proposed to expand the features. Ultimately, the data is split into a training set and the test set, then it sends to the multilayer perceptron, using the L2 norm as the loss function, and evaluate the results to determine whether the model is overfitting or not.</p>
</div>
<div class="section" id="main-portion-of-the-project">
<h2>Main portion of the project<a class="headerlink" href="#main-portion-of-the-project" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The Data Preprocessing. The preprocessing by pandas includes the missing value filling, the text converting, and the data scaling. The method of the missing value filling in the ‘pad’ method, which uses the front normal value to fill the space. The text converting is converting the text into a number (in this dataset, the text is categorial so it can be mapped into numbers). The data scaling method is the min-max normalization method.</p></li>
<li><p>The KMeans clustering. Because the problem is the regression problem, there are no cluster labels. Therefore, to determine the optimal k value, the silhouette method is proposed. Then, the KMeans labels are added to the last column of the data as other features.</p></li>
<li><p>The regression. The multilayer perceptron method is proposed because it has a strong fitting ability. In addition, the dataset is split into the training and the test set to determine whether the model is overfitting or not.</p></li>
</ul>
<p>Import All Package for analysis inially</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">vq</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">trange</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/shared-libs/python3.7/py/lib/python3.7/site-packages/tqdm/auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div>
</div>
</div>
</div>
<p>read the file and show it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;vh_data15.csv&quot;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County_Density</th>
      <th>Vaccine_Trust_Index</th>
      <th>Personal_Responsibility</th>
      <th>Trust_Science_Apolitical</th>
      <th>Trust_Science_Politicians</th>
      <th>Trust_Science_Media</th>
      <th>Trust_Science_Community</th>
      <th>Trust_National</th>
      <th>Trust_State</th>
      <th>Trust_Local</th>
      <th>...</th>
      <th>Pandemic_Impact_Network</th>
      <th>Infected_Personal</th>
      <th>Infected_Network</th>
      <th>Biden</th>
      <th>Trump</th>
      <th>Party_ID</th>
      <th>Household_Income</th>
      <th>Vaccine_Required</th>
      <th>Evangelical</th>
      <th>Vaccine_Hesitant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>137.851795</td>
      <td>0.000000</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.751406</td>
      <td>9.000000</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Democrat</td>
      <td>3.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.103752</td>
      <td>8.666667</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>6.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.912917</td>
      <td>4.000000</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Democrat</td>
      <td>4.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1541.026670</td>
      <td>7.000000</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3348</th>
      <td>470.033815</td>
      <td>1.666667</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>7.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Independent</td>
      <td>8.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3349</th>
      <td>225.323560</td>
      <td>9.333333</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3350</th>
      <td>108.474026</td>
      <td>9.000000</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3351</th>
      <td>63.385677</td>
      <td>9.333333</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Democrat</td>
      <td>12.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3352</th>
      <td>599.558111</td>
      <td>9.000000</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3353 rows × 42 columns</p>
</div></div></div>
</div>
<p>Data PreProcessing by filling in the front of values (pad method) to fill NaN value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pad&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County_Density</th>
      <th>Vaccine_Trust_Index</th>
      <th>Personal_Responsibility</th>
      <th>Trust_Science_Apolitical</th>
      <th>Trust_Science_Politicians</th>
      <th>Trust_Science_Media</th>
      <th>Trust_Science_Community</th>
      <th>Trust_National</th>
      <th>Trust_State</th>
      <th>Trust_Local</th>
      <th>...</th>
      <th>Pandemic_Impact_Network</th>
      <th>Infected_Personal</th>
      <th>Infected_Network</th>
      <th>Biden</th>
      <th>Trump</th>
      <th>Party_ID</th>
      <th>Household_Income</th>
      <th>Vaccine_Required</th>
      <th>Evangelical</th>
      <th>Vaccine_Hesitant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>137.851795</td>
      <td>0.000000</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.751406</td>
      <td>9.000000</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Democrat</td>
      <td>3.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.103752</td>
      <td>8.666667</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>6.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.912917</td>
      <td>4.000000</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Democrat</td>
      <td>4.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1541.026670</td>
      <td>7.000000</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3348</th>
      <td>470.033815</td>
      <td>1.666667</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>7.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Independent</td>
      <td>8.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3349</th>
      <td>225.323560</td>
      <td>9.333333</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3350</th>
      <td>108.474026</td>
      <td>9.000000</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3351</th>
      <td>63.385677</td>
      <td>9.333333</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>No</td>
      <td>Democrat</td>
      <td>12.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3352</th>
      <td>599.558111</td>
      <td>9.000000</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>No</td>
      <td>Yes</td>
      <td>Republican</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3353 rows × 42 columns</p>
</div></div></div>
</div>
<p>Because there are some string in the data, using replace to replace the string</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;No&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;Yes&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;Republican&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;Democrat&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;Independent&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Libertarian&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Other party&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County_Density</th>
      <th>Vaccine_Trust_Index</th>
      <th>Personal_Responsibility</th>
      <th>Trust_Science_Apolitical</th>
      <th>Trust_Science_Politicians</th>
      <th>Trust_Science_Media</th>
      <th>Trust_Science_Community</th>
      <th>Trust_National</th>
      <th>Trust_State</th>
      <th>Trust_Local</th>
      <th>...</th>
      <th>Pandemic_Impact_Network</th>
      <th>Infected_Personal</th>
      <th>Infected_Network</th>
      <th>Biden</th>
      <th>Trump</th>
      <th>Party_ID</th>
      <th>Household_Income</th>
      <th>Vaccine_Required</th>
      <th>Evangelical</th>
      <th>Vaccine_Hesitant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>137.851795</td>
      <td>0.000000</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.751406</td>
      <td>9.000000</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.103752</td>
      <td>8.666667</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.912917</td>
      <td>4.000000</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1541.026670</td>
      <td>7.000000</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3348</th>
      <td>470.033815</td>
      <td>1.666667</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>7.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>8.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3349</th>
      <td>225.323560</td>
      <td>9.333333</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3350</th>
      <td>108.474026</td>
      <td>9.000000</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3351</th>
      <td>63.385677</td>
      <td>9.333333</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>12.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3352</th>
      <td>599.558111</td>
      <td>9.000000</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3353 rows × 42 columns</p>
</div></div></div>
</div>
<p>Sepearate the data and the labels</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vaccine_Hesitant&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">df</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       1
1       0
2       0
3       1
4       0
       ..
3348    1
3349    0
3350    0
3351    0
3352    1
Name: Vaccine_Hesitant, Length: 3353, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Generate the math information of the dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3353 entries, 0 to 3352
Data columns (total 41 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   County_Density             3353 non-null   float64
 1   Vaccine_Trust_Index        3353 non-null   float64
 2   Personal_Responsibility    3353 non-null   float64
 3   Trust_Science_Apolitical   3353 non-null   float64
 4   Trust_Science_Politicians  3353 non-null   float64
 5   Trust_Science_Media        3353 non-null   float64
 6   Trust_Science_Community    3353 non-null   float64
 7   Trust_National             3353 non-null   float64
 8   Trust_State                3353 non-null   float64
 9   Trust_Local                3353 non-null   float64
 10  Trust_Media                3353 non-null   float64
 11  Perceived_Risk             3353 non-null   float64
 12  Perceived_Network_Risk     3353 non-null   float64
 13  Doctor_Comfort             3353 non-null   float64
 14  Fear_Needles               3353 non-null   float64
 15  Condition_Pregnancy        3353 non-null   float64
 16  Condition_Asthma           3353 non-null   float64
 17  Condition_Lung             3353 non-null   float64
 18  Condition_Diabetes         3353 non-null   float64
 19  Condition_Immune           3353 non-null   float64
 20  Condition_Obesity          3353 non-null   float64
 21  Condition_Heart            3353 non-null   float64
 22  Condition_Organ            3353 non-null   float64
 23  County_Cases               3353 non-null   float64
 24  County_Cases2wk            3353 non-null   float64
 25  Male                       3353 non-null   int64  
 26  Race                       3353 non-null   int64  
 27  Age                        3353 non-null   float64
 28  PS_Index                   3353 non-null   float64
 29  Natural_Science_Literacy   3353 non-null   float64
 30  College_Degree             3353 non-null   float64
 31  Pandemic_Impact            3353 non-null   float64
 32  Pandemic_Impact_Network    3353 non-null   float64
 33  Infected_Personal          3353 non-null   float64
 34  Infected_Network           3353 non-null   float64
 35  Biden                      3353 non-null   int64  
 36  Trump                      3353 non-null   int64  
 37  Party_ID                   3353 non-null   int64  
 38  Household_Income           3353 non-null   float64
 39  Vaccine_Required           3353 non-null   int64  
 40  Evangelical                3353 non-null   float64
dtypes: float64(35), int64(6)
memory usage: 1.0 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County_Density</th>
      <th>Vaccine_Trust_Index</th>
      <th>Personal_Responsibility</th>
      <th>Trust_Science_Apolitical</th>
      <th>Trust_Science_Politicians</th>
      <th>Trust_Science_Media</th>
      <th>Trust_Science_Community</th>
      <th>Trust_National</th>
      <th>Trust_State</th>
      <th>Trust_Local</th>
      <th>...</th>
      <th>Pandemic_Impact</th>
      <th>Pandemic_Impact_Network</th>
      <th>Infected_Personal</th>
      <th>Infected_Network</th>
      <th>Biden</th>
      <th>Trump</th>
      <th>Party_ID</th>
      <th>Household_Income</th>
      <th>Vaccine_Required</th>
      <th>Evangelical</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>...</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
      <td>3353.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>882.153305</td>
      <td>7.583408</td>
      <td>7.033701</td>
      <td>5.454817</td>
      <td>2.324187</td>
      <td>3.589323</td>
      <td>6.494483</td>
      <td>5.090665</td>
      <td>5.539815</td>
      <td>6.025649</td>
      <td>...</td>
      <td>4.771399</td>
      <td>4.795407</td>
      <td>0.050701</td>
      <td>0.401432</td>
      <td>0.615866</td>
      <td>0.358187</td>
      <td>1.084402</td>
      <td>6.345959</td>
      <td>0.211452</td>
      <td>0.179242</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2638.189276</td>
      <td>2.532152</td>
      <td>2.477415</td>
      <td>2.850460</td>
      <td>2.225544</td>
      <td>2.952058</td>
      <td>2.540727</td>
      <td>2.431302</td>
      <td>2.539364</td>
      <td>2.251478</td>
      <td>...</td>
      <td>1.699539</td>
      <td>1.684785</td>
      <td>0.219419</td>
      <td>0.490261</td>
      <td>0.486462</td>
      <td>0.479539</td>
      <td>0.921941</td>
      <td>3.684398</td>
      <td>0.408399</td>
      <td>0.383612</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.928098</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>108.384222</td>
      <td>6.333333</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>...</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>299.588930</td>
      <td>8.333333</td>
      <td>7.000000</td>
      <td>5.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>7.000000</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>...</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>715.275377</td>
      <td>9.333333</td>
      <td>9.000000</td>
      <td>8.000000</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>8.000000</td>
      <td>7.000000</td>
      <td>8.000000</td>
      <td>8.000000</td>
      <td>...</td>
      <td>5.500000</td>
      <td>5.500000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>27819.804800</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>...</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>12.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 41 columns</p>
</div></div></div>
</div>
<p>To determine the value of K, after finding the literature, the silhouette method is applied to determine the optimal k value, setting max class of 20</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">K_Silhouette_List</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#Initalizing the silhouette list</span>

<span class="k">for</span> <span class="n">k_value</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
	<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">k_value</span><span class="p">,</span><span class="n">init</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">)</span> <span class="c1">#perform the KMeans clustering</span>
	<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="c1">#obtain the cluster label</span>
	<span class="n">silhouette_avg</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span> <span class="c1">#calculating the silhouette score</span>
	<span class="n">K_Silhouette_List</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k_value</span><span class="p">,</span><span class="n">silhouette_avg</span><span class="p">])</span> <span class="c1">#Adding it into list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 18/18 [00:56&lt;00:00,  3.11s/it]
</pre></div>
</div>
</div>
</div>
<p>Visualize the change of the K_List</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">K_Silhouette_List</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">K_Silhouette_List</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">K_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;K&#39;</span><span class="p">:</span><span class="n">K_Silhouette_List</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;silhouette&#39;</span><span class="p">:</span><span class="n">K_Silhouette_List</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="n">K_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>K</th>
      <th>silhouette</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0.950613</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>0.890727</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>0.672800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>0.658783</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>0.616108</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7.0</td>
      <td>0.537130</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8.0</td>
      <td>0.473735</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.0</td>
      <td>0.536511</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10.0</td>
      <td>0.502654</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11.0</td>
      <td>0.516242</td>
    </tr>
    <tr>
      <th>10</th>
      <td>12.0</td>
      <td>0.501662</td>
    </tr>
    <tr>
      <th>11</th>
      <td>13.0</td>
      <td>0.448177</td>
    </tr>
    <tr>
      <th>12</th>
      <td>14.0</td>
      <td>0.493592</td>
    </tr>
    <tr>
      <th>13</th>
      <td>15.0</td>
      <td>0.449001</td>
    </tr>
    <tr>
      <th>14</th>
      <td>16.0</td>
      <td>0.432740</td>
    </tr>
    <tr>
      <th>15</th>
      <td>17.0</td>
      <td>0.410725</td>
    </tr>
    <tr>
      <th>16</th>
      <td>18.0</td>
      <td>0.391229</td>
    </tr>
    <tr>
      <th>17</th>
      <td>19.0</td>
      <td>0.411393</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Using Altair iteractive chart to show the results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">K_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span>
	    <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
	    <span class="n">height</span><span class="o">=</span><span class="mi">50</span>
	<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
	    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span>
	    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;silhouette&#39;</span><span class="p">,</span>
	<span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span> <span class="c1">#use iteractive chart</span>
<span class="n">chart</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-980367784ab541119bcc3edbc8e2edb4"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-980367784ab541119bcc3edbc8e2edb4") {
      outputDiv = document.getElementById("altair-viz-980367784ab541119bcc3edbc8e2edb4");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-56c3dbbad482e5b6d615204a1199a971"}, "mark": {"type": "point", "height": 50, "width": 100}, "encoding": {"x": {"type": "quantitative", "field": "K"}, "y": {"type": "quantitative", "field": "silhouette"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-56c3dbbad482e5b6d615204a1199a971": [{"K": 2.0, "silhouette": 0.9506134426187849}, {"K": 3.0, "silhouette": 0.8907273263021472}, {"K": 4.0, "silhouette": 0.6727999973439924}, {"K": 5.0, "silhouette": 0.6587832206038494}, {"K": 6.0, "silhouette": 0.616108049372861}, {"K": 7.0, "silhouette": 0.5371295193134061}, {"K": 8.0, "silhouette": 0.473734627671588}, {"K": 9.0, "silhouette": 0.5365105011858073}, {"K": 10.0, "silhouette": 0.5026537616430456}, {"K": 11.0, "silhouette": 0.5162416633485682}, {"K": 12.0, "silhouette": 0.5016617641077813}, {"K": 13.0, "silhouette": 0.44817684845248795}, {"K": 14.0, "silhouette": 0.4935920672014247}, {"K": 15.0, "silhouette": 0.4490014353104637}, {"K": 16.0, "silhouette": 0.4327397890285805}, {"K": 17.0, "silhouette": 0.4107245665425952}, {"K": 18.0, "silhouette": 0.3912291209355897}, {"K": 19.0, "silhouette": 0.41139274875679677}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Obtain the k value by the max value of the silhouette coefficient</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">K_Silhouette_List</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">8</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span> <span class="c1">#Obtain The suitable K value</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Choise of K is&quot;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Choise of K is 2
</pre></div>
</div>
</div>
</div>
<p>After finding the k value, it should use it to perform the K means cluster. But firstly, it should implement the initial center</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">centers</span><span class="p">,</span> <span class="n">kmeanslabels</span> <span class="o">=</span> <span class="n">vq</span><span class="o">.</span><span class="n">kmeans2</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="nb">iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">minit</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/shared-libs/python3.7/py/lib/python3.7/site-packages/scipy/cluster/vq.py:607: UserWarning: One of the clusters is empty. Re-run kmeans with a different initialization.
  warnings.warn(&quot;One of the clusters is empty. &quot;
</pre></div>
</div>
</div>
</div>
<p>Then, Run the KMeans based on the given k value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">#Setting to 1000 to decrese the bias</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">):</span>
	<span class="n">centers</span><span class="p">,</span> <span class="n">kmeanslabels</span> <span class="o">=</span> <span class="n">vq</span><span class="o">.</span><span class="n">kmeans2</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">centers</span><span class="p">,</span> <span class="nb">iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">minit</span> <span class="o">=</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 999/999 [00:02&lt;00:00, 414.15it/s]
</pre></div>
</div>
</div>
</div>
<p>Finally, it should obtain the final kmeans labels</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmeanslabels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeanslabels</span><span class="p">)</span> 
<span class="n">kmeanslabels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       1
1       1
2       1
3       1
4       1
       ..
3348    1
3349    1
3350    1
3351    1
3352    1
Length: 3353, dtype: int32
</pre></div>
</div>
</div>
</div>
<p>add to the last column and show it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">kmeanslabel</span><span class="o">=</span><span class="n">kmeanslabels</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County_Density</th>
      <th>Vaccine_Trust_Index</th>
      <th>Personal_Responsibility</th>
      <th>Trust_Science_Apolitical</th>
      <th>Trust_Science_Politicians</th>
      <th>Trust_Science_Media</th>
      <th>Trust_Science_Community</th>
      <th>Trust_National</th>
      <th>Trust_State</th>
      <th>Trust_Local</th>
      <th>...</th>
      <th>Pandemic_Impact_Network</th>
      <th>Infected_Personal</th>
      <th>Infected_Network</th>
      <th>Biden</th>
      <th>Trump</th>
      <th>Party_ID</th>
      <th>Household_Income</th>
      <th>Vaccine_Required</th>
      <th>Evangelical</th>
      <th>kmeanslabel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>137.851795</td>
      <td>0.000000</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.751406</td>
      <td>9.000000</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.103752</td>
      <td>8.666667</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>6.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.912917</td>
      <td>4.000000</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1541.026670</td>
      <td>7.000000</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3348</th>
      <td>470.033815</td>
      <td>1.666667</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>7.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>8.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3349</th>
      <td>225.323560</td>
      <td>9.333333</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3350</th>
      <td>108.474026</td>
      <td>9.000000</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3351</th>
      <td>63.385677</td>
      <td>9.333333</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>12.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3352</th>
      <td>599.558111</td>
      <td>9.000000</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3353 rows × 42 columns</p>
</div></div></div>
</div>
<p>Next is to perform the regression part. Initially, it should setting the devide of the running, the epoch, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span> <span class="c1">#No cuda would be used</span>
<span class="n">Epoch</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#It should be set larger than this to show the result clearly</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1">#For this model, the max_iter should be set to 50, which means every 50 iteration to perform a test</span>
</pre></div>
</div>
</div>
</div>
<p>Next, Construct the model based on PyTorch</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">512</span><span class="p">),</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
		<span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Because the problem is the regression problem, the loss_function is selected as the MSE</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Defining the optimizer with learning rate of 1e-4 because larger learning rate will cause the network become overfitting fast.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Spliting the data and construct the training set and test set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#For the training set</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#For the testing set</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([3017, 42]) torch.Size([3017, 1])
torch.Size([336, 42]) torch.Size([336, 1])
</pre></div>
</div>
</div>
</div>
<p>Now, it is time to perform the training and testing loop. Notice that in MLP, is has using Loop to iterate over and over again!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Epoch</span><span class="p">):</span>
	<span class="c1">#Training with the training set</span>
	<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
		<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#obtain the predicted value</span>
		<span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1">#compute the loss function</span>
		<span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span> <span class="c1">#clear the gradient in the optimizer</span>
		<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span> <span class="c1">#backwarding the loss</span>
		<span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span> <span class="c1">#update the optimizer</span>

	<span class="c1">#Testing the data using testing set</span>
	<span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
	<span class="n">loss_test</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">y_pred_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">, Training Set Loss:</span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s1">, Test Set Loss:</span><span class="si">{</span><span class="n">loss_test</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 50/50 [00:33&lt;00:00,  1.49it/s]
Epoch0, Training Set Loss:0.5529709458351135, Test Set Loss:0.8505077362060547
100%|██████████| 50/50 [00:33&lt;00:00,  1.51it/s]
Epoch1, Training Set Loss:0.17739205062389374, Test Set Loss:0.21063323318958282
100%|██████████| 50/50 [00:32&lt;00:00,  1.52it/s]
Epoch2, Training Set Loss:0.24123425781726837, Test Set Loss:0.1880612075328827
100%|██████████| 50/50 [00:33&lt;00:00,  1.50it/s]
Epoch3, Training Set Loss:0.116368368268013, Test Set Loss:0.15852192044258118
100%|██████████| 50/50 [00:33&lt;00:00,  1.51it/s]
Epoch4, Training Set Loss:0.10501353442668915, Test Set Loss:0.14747793972492218
100%|██████████| 50/50 [00:33&lt;00:00,  1.49it/s]
Epoch5, Training Set Loss:0.10363566875457764, Test Set Loss:0.15894567966461182
100%|██████████| 50/50 [00:33&lt;00:00,  1.50it/s]
Epoch6, Training Set Loss:0.0968862771987915, Test Set Loss:0.1493232548236847
100%|██████████| 50/50 [00:33&lt;00:00,  1.50it/s]
Epoch7, Training Set Loss:0.09015238285064697, Test Set Loss:0.1419822871685028
100%|██████████| 50/50 [00:33&lt;00:00,  1.51it/s]
Epoch8, Training Set Loss:0.08603479713201523, Test Set Loss:0.14332301914691925
100%|██████████| 50/50 [00:33&lt;00:00,  1.51it/s]Epoch9, Training Set Loss:0.08362097293138504, Test Set Loss:0.13961467146873474
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The Pandas library is applied to read data, implement the missing value filling, and the text converting, while the KMeans is applied to implement the feature engineering. The multilayer perceptron is applied to implement the regression problem. The result shows that the model is overfitting after 2500 iterations, with the minimum mean square error of the regression being 0.13364802300930023 in the test set.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>What is the source of your dataset(s)?
Answer: the source of the dataset is Kaggle</p></li>
</ul>
<ul class="simple">
<li><p>Were any portions of the code or ideas taken from another source?  List those sources here and say how they were used.
Answer: most of my code is original, which sources from the class, or refers to the tutorial in YouTube (See Next Question).</p></li>
</ul>
<ul class="simple">
<li><p>List other references that you found helpful.</p></li>
</ul>
<p>Answer:</p>
<p>The PyTorch tutorial: <a class="reference external" href="https://www.youtube.com/watch?v=c36lUUr864M">https://www.youtube.com/watch?v=c36lUUr864M</a></p>
<p>The tqdm tutorial: <a class="reference external" href="https://www.youtube.com/watch?v=8zm4L3rVreI">https://www.youtube.com/watch?v=8zm4L3rVreI</a></p>
<p>The official document of PyTorch: <a class="reference external" href="https://pytorch.org/docs/stable/index.html">https://pytorch.org/docs/stable/index.html</a></p>
<p>The definition of the silhouette method: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html</a></p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=25e67f76-233b-4a4f-9e44-3e29050463bb' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Proj/StudentProjects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="MitraRezvany.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Airline Satisfaction Analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="TongSu.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Depression Prediction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Christopher Davis<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>